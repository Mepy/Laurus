%start expr 
%space ([\s\t\n]*)

Var = String([_a-zA-Z][_a-zA-Z0-9]*)
Lit = Int::from_str([0-9]|[1-9][0-9]*)
Add = (\+)
Sub = (\-)
Mul = (\*)
Div = (\/)
LParen = (\()
RParen = (\))

LogNot = (!)
LogAnd = (\+\+)
LogOr = (\|\|)
Ques = (\?)
Colon = (:)

Lt = (<)
Le = (<=)
Gt = (>)
Ge = (>=)
Eq = (==)
Ne = (!=)


Assign = (=)
AddAssign = (\+=)
SubAssign = (\-=)
MulAssign = (\*=)
DivAssign = (\/=)


expr : Expr {
< @right Assign(Var Assign expr)
| @right AddAssign(Var AddAssign expr)
| @right SubAssign(Var SubAssign expr)
| @right MulAssign(Var MulAssign expr)
| @right DivAssign(Var DivAssign expr)
< @right Triple(expr Ques expr Colon expr)
< LogOr(expr LogOr expr)
< LogAnd(expr LogAnd expr)
< Eq(expr Eq expr)
| Ne(expr Ne expr)
< Lt(expr Lt expr)
| Le(expr Le expr)
| Gt(expr Gt expr)
| Ge(expr Ge expr)
< Add(expr Add expr)
| Sub(expr Sub expr)
< Mul(expr Mul expr)
| Div(expr Div expr) 
< LogNot(LogNot expr)
< Lit(Lit)
| Var(Var)
| (LParen expr RParen)
}